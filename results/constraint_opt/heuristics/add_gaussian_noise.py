import numpy as np
import pandas as pd

"""
Add gaussian noise with mean zero and standard deviation std on decision variables generated by heuristics.
"""
from util.config_hco import PhysicalProperties, Generator1

columns = ["T_supply_optimized", "Q_optimized", "Heat_demand", "Electricity_price"]
std = 0.5

heuristic = {
    "abdollahi": pd.read_csv("abdollahi.csv", usecols=columns),
    "giraud": pd.read_csv("giraud.csv", usecols=columns),
}
noise = {
    "abdollahi": np.random.normal(0, 0.5, len(heuristic["abdollahi"])),
    "giraud": np.random.normal(0, 0.5, len(heuristic["giraud"])),
}
violations = {
    "T_supply_optimized": {
        "min": PhysicalProperties["MinSupTemp"],
        "max": PhysicalProperties["MaxTemp"],
    },
    "Q_optimized": {"min": Generator1["MinHeatProd"], "max": Generator1["MaxHeatProd"]},
}


for key in heuristic.keys():
    for column in ["T_supply_optimized", "Q_optimized"]:
        heuristic[key][column] = heuristic[key][column] + noise[key]
        for i in range(len(heuristic[key][column])):
            if heuristic[key][column][i] < violations[column]["min"]:
                heuristic[key][column][i] = violations[column]["min"]
            elif heuristic[key][column][i] > violations[column]["max"]:
                heuristic[key][column][i] = violations[column]["max"]

for key in heuristic.keys():
    heuristic[key].to_csv(key + "_gaussian_noise.csv", index=True)
